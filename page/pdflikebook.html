<html>

<head>
    <title>署史</title>
    <meta name="viewport" content="width = 1050, user-scalable = no" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
    <script src="../js/fuc.js"></script>
    <script src="../js/active.js"></script>
    <script src="../js/tpk.js"></script>
    <script src="../library/jquery/pdfobject.js"></script>
    <!--    <link rel="stylesheet" href="../library/turn/basic.css">-->
    <script src="../library/turn/turn.js"></script>
    <!--    <script src="../library/turn/turn.html4.min.js"></script>-->
    <!--    <link rel="stylesheet" href="../library/turn/basic.css">-->
</head>
<style>
    .pdfobject-container {
        height: 700px;
    }
    
    .pdfobject {
        border: 1px solid #666;
    }
    
    body {
        background-color: #020202;
        margin: 0;
        padding: 0;
    }
    
    .flipbook-viewport {
        overflow:hidden;
        width: 100%;
        height: 100%;
        margin-top:10px;
    }
    
    .flipbook-viewport .container {
        position: relative;
        margin-left: 10%;
    }
    
    .flipbook-viewport .flipbook {
        margin: auto;
    }
    
    .flipbook-viewport .page {
        width: 550px;
        height: 780px;
        background-color: white;
        background-repeat: no-repeat;
        background-size: 100% 100%;
    }
    
    .flipbook .page {
        -webkit-box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        -moz-box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        -ms-box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        -o-box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
    }
    
    .flipbook-viewport .page img {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        margin: 0;
    }
    
    .flipbook-viewport .shadow {
        -webkit-transition: -webkit-box-shadow 0.5s;
        -moz-transition: -moz-box-shadow 0.5s;
        -o-transition: -webkit-box-shadow 0.5s;
        -ms-transition: -ms-box-shadow 0.5s;
        -webkit-box-shadow: 0 0 20px #ccc;
        -moz-box-shadow: 0 0 20px #ccc;
        -o-box-shadow: 0 0 20px #ccc;
        -ms-box-shadow: 0 0 20px #ccc;
        box-shadow: 0 0 20px #ccc;
    }
</style>
<script>
    var angular = angular.module("book", []);
    angular.directive("loadend", function () {
        return {
            restrict: "A",
            link: function (scope, element, attrs) {
                if (scope.$last) {
                    var w_height=window.innerHeight;
                    var w_width=window.innerWidth;
                    var widtha=0,height=w_height;
                    widtha=w_width*(height/1000)-50;
                    console.log(widtha);
                    $('.flipbook').turn({
                        // Width
                        width: (widtha),
                        autoCenter: true,
                        // Height
                        height:height ,
                        // Elevation
                        elevation: 50,
                        // Enable gradients
                        gradients: true,
                        // Auto center this flipbook
                        autoCenter: true,
                        display: 'double',
                        when: {
                            missing: function (event, pages) {
                            }
                        }
                    });
                    $('.flipbook>div').bind("click",function (){
                        console.log($(this).attr("page"));
                        console.log( $('.flipbook').turn("page"));
                        //$('.flipbook').turn("next")
                        
                        
                    });
                    var width = $(window).width();
                    //console.log(width);
                    
                    $(".flipbook-viewport>.container").css("margin-left", (width - (widtha)) / 2);
                }


            }
        }


    })
    angular.controller("repeat-img", function ($scope, $http) {
        var t = "";
        $http.get("../data/history/" + usearch['pdf'] + ".csv").success(function (data) {
            var tm = get_csv(data, ["image"]);

            $scope.t = tm;
        })

    })
</script>

<body ng-app="book">
    <div class="flipbook-viewport">
        <div class="container">
            <div class="flipbook" ng-controller="repeat-img">
                <div><img src="../image/history/home.png" / width="100%"></div>
                <div ng-repeat="k in t" loadend>
                    <img ng-src="../{{k.image}}" width="100%" alt="">
                </div>
                <div>
                    <div style="text-align:center; background-color:#FFF;width:100%;height:100%;padding:20px;">
                        <h2 style='margin-top:25%'>本篇章已觀看完畢</h2>

                    </div>


                </div>
            </div>
        </div>
    </div>

</body>


</html>